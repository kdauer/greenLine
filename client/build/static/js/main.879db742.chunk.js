(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{22:function(e,t,a){},36:function(e,t,a){e.exports=a(64)},41:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(32),o=a.n(s),i=(a(41),a(15)),l=a(1),c=a(2),u=a(4),m=a(3),p=a(5),h=(a(22),a(16)),d=a(9),g=a.n(d),f=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",message:""},a.handleChange=function(e){a.setState(Object(h.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),g.a.post("/api/auth/signup",{username:a.state.username,password:a.state.password}).then((function(e){a.props.history.push("/"),a.props.setUser(e.data)})).catch((function(e){a.setState({message:e.response.data.message})}))},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("label",{htmlFor:"username"},"Username: "),r.a.createElement("input",{type:"text",id:"username",name:"username",value:this.state.username,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"password"},"Password: "),r.a.createElement("input",{type:"password",name:"password",id:"password",value:this.state.password,onChange:this.handleChange}),r.a.createElement("button",{type:"submit"},"Sign up")),this.state.message&&r.a.createElement("p",null,this.state.message))}}]),t}(n.Component),v=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",message:""},a.handleChange=function(e){a.setState(Object(h.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),g.a.post("/api/auth/login",{username:a.state.username,password:a.state.password}).then((function(e){a.props.history.push("/"),a.props.setUser(e.data)})).catch((function(e){a.setState({message:e.response.data.message})}))},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("label",{htmlFor:"username"},"Username: "),r.a.createElement("input",{type:"text",id:"username",name:"username",value:this.state.username,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"password"},"Password: "),r.a.createElement("input",{type:"password",name:"password",id:"password",value:this.state.password,onChange:this.handleChange}),r.a.createElement("button",{type:"submit"},"Sign in")),this.state.message&&r.a.createElement("p",null,this.state.message))}}]),t}(n.Component),b=a(7),E=function(e){return e.user?r.a.createElement("nav",{className:"navbar"},r.a.createElement("img",{className:"Logo",height:"128px",src:"/GreenLineLogo.png",alt:"Logo"}),r.a.createElement(b.b,{to:"/",onClick:e.resetTripResults},r.a.createElement("img",{className:"HomeIcon Icon",src:"/home.svg",alt:"Home",height:"32px"}),r.a.createElement("p",null,"Home")),r.a.createElement(b.b,{to:"/user"},r.a.createElement("img",{className:"HomeIcon Icon",src:"/user.svg",alt:"User",height:"32px"}),r.a.createElement("p",null,"User")),r.a.createElement(b.b,{onClick:function(){g.a.delete("/api/auth/logout").then((function(){e.setUser(null)}))},to:"/"},r.a.createElement("img",{className:"LogoutIcon Icon",src:"/logout.svg",alt:"Logout",height:"32px"}),r.a.createElement("p",null,"Logout"))):r.a.createElement("nav",{className:"navbar"},r.a.createElement("img",{className:"Logo",height:"128px",src:"/GreenLineLogo.png",alt:"Logo"}),r.a.createElement(b.b,{className:"navbar-home",to:"/",onClick:e.resetTripResults},r.a.createElement("img",{className:"HomeIcon Icon",src:"/home.svg",alt:"Home",height:"32px"}),r.a.createElement("p",null,"Home")),r.a.createElement(b.b,{className:"navbar-login",to:"/login"},r.a.createElement("img",{className:"LoginIcon Icon",src:"/login.svg",alt:"Login",height:"32px"}),r.a.createElement("p",null,"Login")),r.a.createElement(b.b,{className:"navbar-login",to:"/signup"},r.a.createElement("img",{className:"SignupIcon Icon",src:"/signup.svg",alt:"Signup",height:"32px"}),r.a.createElement("p",null,"Signup")))},y=a(13),j=a(35),w=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={loading:!0,showLoader:!0},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.state.loading&&e.setState({showLoader:!1})}),4e3)}},{key:"render",value:function(){var e=this,t=[];this.props.results.forEach((function(e){t.includes(e.address.city)||t.push(e.address.city)}));var a=this.props.results.slice(0,10).map((function(t){return r.a.createElement("li",{className:"AutocompleteItem",key:t.id,onClick:function(a){e.props.updateText(a.target.innerText,t.id)}},t.name)}));return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{className:"inputText",placeholder:this.props.placeholder,name:this.props.name,id:this.props.id,onChange:this.props.onChange,value:this.props.value}),!this.state.showLoader&&r.a.createElement("ul",{className:"AutocompleteList"},t.map((function(t,a){return r.a.createElement("li",{className:"AutocompleteItem",key:a,onClick:function(a){e.props.updateText(a.target.innerText,t.id)}},t)})),a))}}]),t}(n.Component),C=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={trip:a.props.selectedTrip},a.onlyHour=function(e){return e.slice(11,16)},a.convert=function(e,t){var a=new Date(e),n=new Date(t);return new Date(+n-+a).toLocaleTimeString().slice(0,4)},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.state.trip.legs.map((function(t,a){return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,e.onlyHour(t.departure)," ",t.origin.name," Platfrom:",t.departurePlatform,"=>",e.onlyHour(t.arrival)," ",t.destination.name," Platfrom:",t.arrivalPlatform,"Duration: ",e.convert(t.departure,t.arrival)," |train:",t.line.name,"|",e.state.trip.legs[a+1]&&"Transfer Time:\n                  ".concat(e.convert(t.arrival,e.state.trip.legs[a+1].departure))))})),r.a.createElement("a",{href:"https://www.bahn.com/en/view/index.shtml"},r.a.createElement("button",null,"Book Now")))}}]),t}(n.Component),O=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={showDetail:!1},a.handleClick=function(){a.state.showDetail?a.setState({showDetail:!1}):a.setState({showDetail:!0})},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=new Date(this.props.detail.legs[0].departure),t=new Date(this.props.detail.legs[this.props.detail.legs.length-1].arrival),a=new Date(t-e).toLocaleTimeString();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{key:this.props.detail.id,onClick:this.handleClick},r.a.createElement("p",null,"at:",this.props.detail.legs[0].departure.slice(11,16),"From: ",this.props.detail.origin.name," Platform:",this.props.detail.legs[0].departurePlatform),r.a.createElement("p",null,"at:",this.props.detail.legs[0].arrival.slice(11,16),"To: ",this.props.detail.destination.name,"Platform:",this.props.detail.legs[0].arrivalPlatform),r.a.createElement("p",null,"Duration: ",a.slice(0,2)+"h"+a.slice(3,5)+"m"),r.a.createElement("p",null,"Changes: ",this.props.detail.legs.length-1),r.a.createElement("p",null,"2nd Class:",this.props.detail.normalPrice,"0 \u20ac"),r.a.createElement("p",null,"1st Class:",this.props.detail.firstClass?this.props.detail.firstClass:"not available","0 \u20ac"),r.a.createElement("ul",null,this.props.detail.legs.map((function(e,t){return r.a.createElement("li",{key:t,style:{border:"1px solid red"}},e.line.product)}))),this.state.showDetail?r.a.createElement(C,{selectedTrip:this.props.detail}):r.a.createElement("div",null)))}}]),t}(n.Component),S=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(n.Component),I=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={results:[]},a.sortByPrice=function(){var e=Object(i.a)(a.state.results).sort((function(e,t){return e.normalPrice-t.normalPrice}));a.setState({results:e})},a.sortByTime=function(){var e=Object(i.a)(a.state.results).sort((function(e,t){return e.legs[0].departure.localeCompare(t.legs[0].departure)}));a.setState({results:e})},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.resultData.map((function(t,a){var n,r={};return r.origin=t.origin,r.destination=t.destination,r.normalPrice=t.price.amount,r.firstClass=null===(n=e.props.firstClass[a])||void 0===n?void 0:n.price.amount,r.legs=t.legs,r.id=t.id,r})),a=Object(i.a)(t).sort((function(e,t){return e.legs[0].departure.localeCompare(t.legs[0].departure)}));console.log("sorted results here",a),this.setState({results:a})}},{key:"componentDidUpdate",value:function(e,t){var a=this;if(e!==this.props){var n=this.props.resultData.map((function(e,t){var n,r={};return r.origin=e.origin,r.destination=e.destination,r.normalPrice=e.price.amount,r.firstClass=null===(n=a.props.firstClass[t])||void 0===n?void 0:n.price.amount,r.legs=e.legs,r.id=e.id,r})),r=Object(i.a)(n).sort((function(e,t){return e.legs[0].departure.localeCompare(t.legs[0].departure)}));this.setState({results:r})}}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(S,null),r.a.createElement("div",{className:"Filter"},r.a.createElement("button",{onClick:this.sortByPrice},"Sort by Price"),r.a.createElement("img",{height:"16px",src:"/filter.svg",alt:"Filter"}),r.a.createElement("button",{onClick:this.sortByTime},"Sort by Time")),this.state.results.map((function(e){return r.a.createElement(O,{detail:e,key:e.id})})))}}]),t}(n.Component);Date.prototype.toDateInputValue=function(){var e=new Date(this);return e.setMinutes(this.getMinutes()-this.getTimezoneOffset()),e.toJSON().slice(0,16)},console.log(new Date);var k=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={date:(new Date).toDateInputValue(),from:"",to:"",toId:"",fromId:"",class:"",travelers:"",resultTo:[],resultFrom:[],id:"",savedJourney:[],resultData:[],firstClass:[]},a.handleChange=function(e){var t=e.target.value;a.setState({date:t})},a.searchPrice=function(e){a.setState({resultData:[]});var t=e.fromId;t||(t=e.from);var n=e.toId;n||(n=e.to);var r=g.a.get("/api/price?date="+e.date.slice(0,16)+"&fromId="+t+"&toId="+n);console.log("date format",e.date.slice(0,16));var s=g.a.get("/api/firstPrice");a.setState({resultData:[]},(function(){Promise.all([r,s]).then((function(e){var t=Object(j.a)(e,2),n=t[0],r=t[1];console.log(n.data.length),a.setState({resultData:n.data,firstClass:r.data},(function(){a.props.resultListSetTrue()}))}))}))},a.handleSubmit=function(e){e.preventDefault(),a.searchPrice(a.state)},a.getStations=function(e){g.a.post("/cities",{to:a.state.to,from:a.state.from}).then((function(t){if("to"===e){var n=t.data.resultTo;""===a.state.to&&(n=[]),a.setState({resultTo:n})}else{var r=t.data.resultFrom;""===a.state.from&&(r=[]),a.setState({resultFrom:r})}}))},a.handleInputChange=function(e){var t=e.target.name;a.setState(Object(h.a)({},e.target.name,e.target.value),(function(){a.getStations(t)}))},a.updateText=function(e,t){a.setState({from:e,fromId:t,resultFrom:[]})},a.updateTo=function(e,t){a.setState({to:e,toId:t,resultTo:[]})},a.handleClickSave=function(e){g.a.post("/api/journeys",{to:a.state.to,toId:a.state.toId,from:a.state.from,fromId:a.state.fromId,date:a.state.date.slice(0,16)}).then((function(e){a.setState({savedJourney:e.data}),a.props.setFavorites(a.state.savedJourney),console.log("journey detail in searchform:",a.state.savedJourney)}))},a.reverseDestinations=function(){a.setState({to:a.state.from,from:a.state.to,toId:a.state.fromId,fromId:a.state.toId})},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.location.state&&(this.searchPrice(this.props.location.state),window.history.pushState(null,""))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"Searchform"},r.a.createElement("label",{htmlFor:"From"}),r.a.createElement(w,{placeholder:"From:",name:"from",id:"from",updateText:this.updateText,results:this.state.resultFrom,value:this.state.from,onChange:this.handleInputChange}),r.a.createElement("label",{htmlFor:"To"}),r.a.createElement("br",null),r.a.createElement("button",{className:"ReverseButton",onClick:this.reverseDestinations},r.a.createElement("img",{height:"16px",src:"/swap-vertical.svg",alt:"switch"})),r.a.createElement("br",null),r.a.createElement(w,{placeholder:"To:",name:"to",id:this.state.toId,updateText:this.updateTo,results:this.state.resultTo,value:this.state.to,onChange:this.handleInputChange}),r.a.createElement("label",{htmlFor:"Date"}),r.a.createElement("input",{className:"inputDate",type:"datetime-local",id:"date",name:"date",value:this.state.date,onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("button",{className:"SubmitButton",type:"submit",onClick:this.handleSubmit},"Find Prices"),r.a.createElement("br",null),this.props.isLoggedIn?r.a.createElement("button",{onClick:this.handleClickSave},r.a.createElement("img",{height:"32px",src:"/fav.svg",alt:"Favourite"})):r.a.createElement(b.b,{id:"favlink",to:"/Login"},"Login to save this trip")),r.a.createElement("div",null),this.props.resultListRender?r.a.createElement(I,{isLoggedIn:this.props.isLoggedIn,resultData:this.state.resultData,firstClass:this.state.firstClass}):r.a.createElement("div",null))}}]),t}(n.Component),D=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).searchFavorite=function(e){e.preventDefault(),console.log("SEARCHINGGG",e.target)},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.searchFavorite},this.props.favorites.map((function(t){return r.a.createElement("div",{key:e.props.favorites._id},t.origin,t.destination,t.date.slice(0,21),r.a.createElement(b.b,{to:{pathname:"/",state:{date:t.date.slice(0,16),fromId:t.originId,toId:t.destinationId,to:t.origin,from:t.destination}}},r.a.createElement("button",null,"Search")))}))))}}]),t}(n.Component),T=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={user:a.props.user,resultListRender:!1,favorites:a.props.favorites||[]},a.setUser=function(e){a.setState({user:e})},a.resetTripResults=function(){a.setState({resultListRender:!1})},a.resultListSetTrue=function(){a.setState({resultListRender:!0})},a.setFavorites=function(e){a.setState({favorites:[].concat(Object(i.a)(a.state.favorites),[e])}),console.log("favorites in App working",a.state.favorites)},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement(E,{setUser:this.setUser,user:this.state.user,resetTripResults:this.resetTripResults}),r.a.createElement("div",null,r.a.createElement(y.a,{path:"/login",render:function(t){return r.a.createElement(v,{history:t.history,setUser:e.setUser})}})),r.a.createElement("div",null,r.a.createElement(y.a,{path:"/signup",render:function(t){return r.a.createElement(f,{history:t.history,setUser:e.setUser})}})),r.a.createElement(y.a,{path:"/user",render:function(t){return r.a.createElement(D,{history:t.history,setUser:e.setUser,favorites:e.state.favorites})}}),r.a.createElement("div",{className:"HomeImage"}),r.a.createElement(y.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(k,Object.assign({},t,{isLoggedIn:Boolean(e.state.user),resultListSetTrue:e.resultListSetTrue,resultListRender:e.state.resultListRender,setFavorites:e.setFavorites}))}}))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));g.a.get("/api/auth/loggedin").then((function(e){o.a.render(r.a.createElement(b.a,null,r.a.createElement(T,{user:e.data,favorites:e.data.favorites})),document.getElementById("root"))})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[36,1,2]]]);
//# sourceMappingURL=main.879db742.chunk.js.map